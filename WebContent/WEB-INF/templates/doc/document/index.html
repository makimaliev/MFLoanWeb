<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.w3.org/1999/xhtml">
<!-- begin::Head -->
<head>
    <div th:replace="fragments/header :: header-css"/>


</head>
<!-- end::Head -->

<!-- end::Body -->
<body class="m-page--fluid m--skin- m-content--skin-light2 m-header--fixed m-header--fixed-mobile m-aside-left--enabled m-aside-left--skin-dark m-aside-left--offcanvas m-footer--push m-aside--offcanvas-default m-aside-left--minimize m-brand--minimize"  >
<!-- begin:: Page -->

<div class="m-grid m-grid--hor m-grid--root m-page">
    <!-- BEGIN: Header -->
    <div th:replace="layout/header"/>
    <!-- END: Header -->
    <!-- begin::Body -->
    <div class="m-grid__item m-grid__item--fluid m-grid m-grid--ver-desktop m-grid--desktop m-body">
        <!-- BEGIN: Left Aside -->
        <div th:replace="layout/sidebar"/>
        <!-- END: Left Aside -->
        <div class="m-grid__item m-grid__item--fluid m-wrapper">
            <div class="m-content">
                <div class="m-portlet m-portlet--mobile">
                    <div class="m-portlet__head">
                        <div class="m-portlet__head-caption">
                            <div class="m-portlet__head-title">
                                <h3 class="m-portlet__head-text" th:text="${'Список документов : ' + title}"></h3>
                            </div>
                        </div>
                        <div class="m-portlet__head-tools">
                            <ul class="m-portlet__nav">
                                <li class="m-portlet__nav-item">
                                    <div class="m-input-icon m-input-icon--left">
                                        <input type="text" class="form-control m-input" th:placeholder="#{label.search}" id="generalSearch">
                                        <span class="m-input-icon__icon m-input-icon__icon--left">
                                            <span><i class="la la-search"></i></span>
                                        </span>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="m-portlet__body">

                        <th:block th:replace="doc/layout::__${type + 'Index'}__"/>
                        <!--table class="table table-bordered table-hover" id="ddt">
                            <thead class="thead-default">
                                <tr>
                                    <th>1</th>
                                    <th>2</th>
                                    <th>3</th>
                                    <th>4</th>
                                    <th>5</th>
                                    <th>6</th>
                                </tr>
                            </thead>
                        </table-->

                    </div>
                    <div class="m-portlet__foot">

                        <span th:if="${type=='incoming'}" sec:authorize="hasAnyAuthority('PERM_ADD_INCOMEDOC')" th:each="dst : ${documentSubTypes}">
                            <a th:href="@{/doc/new/__${dst.internalName}__}" class="btn btn-success" th:text="${dst.name}"> New Document </a>
                        </span>
                        <span th:if="${type=='outgoing' or type=='internal'}" th:each="dst : ${documentSubTypes}">
                            <a th:href="@{/doc/new/__${dst.internalName}__}" class="btn btn-success" th:text="${dst.name}"> New Document </a>
                        </span>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- END CONTENT BODY -->
    <!-- begin::Footer -->
    <div th:replace="layout/footer"/>
    <!-- end::Footer -->
</div>
<div class="m-scroll-top m-scroll-top--skin-top" data-toggle="m-scroll-top" data-scroll-offset="500" data-scroll-speed="300">
    <i class="la la-arrow-up"></i>
</div>
<div th:replace="fragments/footer :: footer-js"/>

<script th:src="@{/assets/global/plugins/datatables/datatables.js}" type="text/javascript"></script>

<script type="text/javascript">
    (function($) {
        var r20 = /%20/g, rbracket = /\[\]$/, rCRLF = /\r?\n/g, rsubmitterTypes = /^(?:submit|button|image|reset|file)$/i, rsubmittable = /^(?:input|select|textarea|keygen)/i;

        function customBuildParams(prefix, obj, traditional, add) {
            var name;

            if (jQuery.isArray(obj)) {
                // Serialize array item.
                jQuery.each(obj, function(i, v) {
                    if (traditional || rbracket.test(prefix)) {
                        // Treat each array item as a scalar.
                        add(prefix, v);

                    } else {
                        // Item is non-scalar (array or object), encode its numeric
                        // index.
                        customBuildParams(prefix + "["
                            + (typeof v === "object" ? i : "") + "]", v,
                            traditional, add);
                    }
                });

            } else if (!traditional && jQuery.type(obj) === "object") {
                // Serialize object item.
                for (name in obj) {
                    // This is where the magic happens
                    customBuildParams(prefix + "." + name, obj[name], traditional,
                        add);
                }

            } else {
                // Serialize scalar item.
                add(prefix, obj);
            }
        }

        $.param = function(a, traditional) {
            var prefix, s = [], add = function(key, value) {
                // If value is a function, invoke it and return its value
                value = jQuery.isFunction(value) ? value() : (value == null ? ""
                    : value);
                s[s.length] = encodeURIComponent(key) + "="
                    + encodeURIComponent(value);
            };

            // Set traditional to true for jQuery <= 1.3.2 behavior.
            if (traditional === undefined) {
                traditional = jQuery.ajaxSettings
                    && jQuery.ajaxSettings.traditional;
            }

            // If an array was passed in, assume that it is an array of form
            // elements.
            if (jQuery.isArray(a) || (a.jquery && !jQuery.isPlainObject(a))) {
                // Serialize the form elements
                jQuery.each(a, function() {
                    add(this.name, this.value);
                });

            } else {
                // If traditional, encode the "old" way (the way 1.3.2 or older
                // did it), otherwise encode params recursively.
                for (prefix in a) {
                    customBuildParams(prefix, a[prefix], traditional, add);
                }
            }

            // Return the resulting serialization
            return s.join("&").replace(r20, "+");
        };
    })(jQuery);
</script>

<script type="text/javascript" th:inline="javascript">

    $(document).ready(function()
    {
        var dtOptions = {
            stateSave: false,
            info: '',
            language: {
                emptyTable: "<center>Нет данных</center>",
                lengthMenu: "_MENU_",
                zeroRecords: "",
                info: "",
                search: "Search : ... ",
                paginate: {
                    first: '<i class="la la-angle-double-left"></i>',
                    previous: '<i class="la la-angle-left"></i>',
                    next: '<i class="la la-angle-right"></i>',
                    last: '<i class="la la-angle-double-right"></i>'
                }
            },
            sDom: 'rtlip',
        };
        var table = $('#documentTable').DataTable(dtOptions);

        /*
        var t1 = $('#ddt').DataTable({
            paging: true,
            processing: true,
            ajax: '/doc/documents',
            serverSide: true,
            columns: [
                {
                    data: 'id'
                },
                {
                    data: 'title'
                },
                {
                    data: 'documentSubType.name'
                },
                {
                    data: 'owner.staff.name'
                },
                {
                    data: 'senderRegisteredNumber'
                },
                {
                    data: 'senderRegisteredDate',
                    render: function (data) { return data + '$'; }
                }
            ]
        });

        /*
        $('#documentTable tbody').on( 'click', 'td', function () {
            alert( table.cell( this ).data() );
        } );
        */

        $(".registeraction").click(function(e) {

            e.preventDefault()
            console.log("ok");
            /*
            $.ajax({
                url: $(this).attr('href'),
                success: function(response) {
                    table.cell($(this).closest("tr"), 3).data(response)
                }
            });
            */
            return false;
        });

        $('#generalSearch').keyup(function(){
            table.search($(this).val()).draw() ;
        });
    });

</script>

</body>
</html>