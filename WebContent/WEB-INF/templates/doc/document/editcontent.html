<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">

<body>
<th:block th:fragment="internal">
    <!-- Internal -->
    <!-- Sender Registration and Registration Data -->
    <input type="hidden" th:field="*{senderRegisteredNumber}"/>
    <input type="hidden" th:field="*{senderRegisteredDate}"/>
    <input type="hidden" th:field="*{receiverRegisteredNumber}"/>
    <input type="hidden" th:field="*{receiverRegisteredDate}"/>

    <!-- Receiver Responsible -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label"> Кому : </label>
        <div th:class="*{documentState.ordinal() > 4} or ${cu == #authentication.name} ? 'col-0' : 'col-3'" th:hidden="*{documentState.ordinal() > 4}">
            <select class="s2s form-control" id="rrt_select" th:field="*{receiverResponsible.responsibleType}" style="width:100%">
                <option value="1">Сотрудник</option>
                <!--option value="2">Отдел</option-->
            </select>
        </div>
        <div th:class="*{documentState.ordinal() > 4} ? 'col-9' : 'col-6'">
            <div class="rdr" id="ri1" th:hidden="*{documentState.ordinal() > 4}">
                <select class="s2 form-control" th:field="*{receiverResponsible.staff}" multiple="multiple" style="width: 100%" data-ajax--url="/doc/data/staff">
                    <option th:each="r : *{receiverResponsible?.staff}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div>
            <!--div class="rdr" id="ri2" th:hidden="*{documentState.ordinal() > 4}">
                <select class="s2 form-control" th:field="*{receiverResponsible.departments}" multiple="multiple" style="width: 100%" data-ajax--url="/doc/data/department">
                    <option th:each="r : *{receiverResponsible?.departments}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div-->
            <label class="form-control" th:each="s : *{receiverResponsible.staff}" th:text="${s.name}" th:if="*{documentState.ordinal() > 4}"> Staff </label>
            <!--label class="form-control" th:each="d : *{receiverResponsible.departments}" th:text="${d.name}" th:if="*{documentState.ordinal() > 4}"> Staff </label-->
        </div>
    </div>
    <!-- Sender Responsible -->
    <div class="form-group m-form__group row">
        <input type="hidden" id="senderResponsible.responsibleType" name="senderResponsible.responsibleType" value="1">
        <label class="col-3 col-form-label"> ОТ КОГО : </label>
        <div class="col-9">
            <div th:hidden="*{documentState.ordinal() > 4}">
                <select class="s2 form-control m-input" th:field="*{senderResponsible.staff}" multiple="multiple" data-ajax--url="/doc/data/staff" style="width:100%" required>
                    <option th:each="r : *{senderResponsible?.staff}"
                            th:value="${r.id}"
                            th:text="${r.name}">Staff</option>
                </select>
            </div>
            <label class="form-control" th:each="s : *{senderResponsible.staff}" th:text="${s.name}" th:if="*{documentState.ordinal() > 4}"> Staff </label>
        </div>
    </div>
    <!-- TITLE -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label"> Относительно : </label>
        <div class="col-9">
            <input class="form-control" required th:field="*{title}" autocomplete="off" th:type="*{documentState.ordinal() < 5} ? 'text' : 'hidden'">
            <label class="form-control" th:text="*{title}" th:if="*{documentState.ordinal() > 4}"> Title </label>
        </div>
    </div>
    <!-- DESCRIPTION -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label"> Краткое содержание : </label>
        <div class="col-9">
            <textarea th:field="*{description}" required></textarea>
        </div>
    </div>
    <!-- Attachment -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label"> Приложения : </label>
        <div class="col-9" id="attachmentList">
            <button type="button" class="btn btn-primary mb-3" data-toggle="modal" data-target="#attachment">Добавить</button>
            <input type="hidden" name="files" value="0">
            <table id="documentAttachments" class="form-control">
                <tr th:if="*{#lists.isEmpty(attachments)}"><td><label>Нет приложений</label></td></tr>
                <tr th:if="*{not #lists.isEmpty(attachments)}" th:each="attachment : *{attachments}">
                    <td><a th:href="@{/doc/attachments/download/__${attachment.id}__}"><label th:text="${attachment.name}"></label></a></td>
                </tr>
            </table>
        </div>
    </div>
    <!-- Document Due Date -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label"> Срок : </label>
        <div class="col-9">
            <input class="dtp form-control" th:field="*{documentDueDate}" th:type="*{documentState.ordinal() < 4} ? 'text' : 'hidden'" autocomplete="off" readonly="readonly"/>
            <label class="form-control" data-date-format="dd-mm-yyyy" th:text="*{documentDueDate} != null ? *{#dates.format(documentDueDate, 'dd-MM-yyyy HH:mm')} : 'Срок не установлен'" th:if="*{documentState.ordinal() > 4}"> Title </label>
        </div>
    </div>
    <!-- Receiver Executor -->
    <div class="form-group m-form__group row" th:if="*{documentState.ordinal() > 8}">
        <label class="col-3 col-form-label"> Испонитель : </label>
        <div class="col-9">
            <input type="hidden" th:field="*{receiverExecutor.executorType}">
            <select hidden th:field="*{receiverExecutor.staff}" multiple>
                <option th:each="r : *{receiverExecutor?.staff}"
                        th:value="${r.id}"
                        th:text="${r.name}">Responsible</option>
            </select>
            <label class="form-control" th:each="s : *{receiverExecutor.staff}" th:text="${s.name}"> Staff </label>
        </div>
    </div>
    <!-- Comment -->
    <div class="form-group m-form__group row" th:hidden="${not hasReject}">
        <label class="col-3 col-form-label"> Примечание : </label>
        <div class="col-sm-9">
            <textarea class="form-control" rows="5" th:field="*{comment}" value=" "></textarea>
        </div>
    </div>
</th:block>
<th:block th:fragment="incoming">
    <!-- Incomming -->
    <!-- Sender Responsible -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> От Кого :  </span>
        </label>
        <div th:class="*{documentState.ordinal() > 0} ? 'col-0' : 'col-3'" th:hidden="*{documentState.ordinal() > 0}">
            <select class="s2s form-control" id="srt_select" th:field="*{senderResponsible.responsibleType}" style="width:100%">
                <option value="3">Организация</option>
                <option value="4">ФИЗ Лицо</option>
            </select>
        </div>
        <div th:class="*{documentState.ordinal() > 0} ? 'col-9' : 'col-6'">
            <div class="sdr" id="si3" th:hidden="*{documentState.ordinal() > 0}">
                <select class="s2 form-control" th:field="*{senderResponsible.organizations}" multiple="multiple" style="width:100%" data-ajax--url="/doc/data/organizations">
                    <option th:each="r : *{senderResponsible?.organizations}"
                            th:value="${r.id}"
                            th:text="${r.name}">Organizations</option>
                </select>
            </div>
            <div class="sdr" id="si4" th:hidden="*{documentState.ordinal() > 0}">
                <select class="s2 form-control" th:field="*{senderResponsible.person}" multiple="multiple" style="width:100%" data-ajax--url="/doc/data/person">
                    <option th:each="r : ${senderResponsible?.person}"
                            th:value="${r.id}"
                            th:text="${r.name}">Person</option>
                </select>
            </div>
            <label class="form-control" th:each="s : *{senderResponsible.organizations}" th:text="${s.name}" th:if="*{documentState.ordinal() > 0}"> Staff </label>
            <label class="form-control" th:each="s : *{senderResponsible.person}" th:text="${s.name}" th:if="*{documentState.ordinal() > 0}"> Staff </label>
        </div>
    </div>
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span></span>
        </label>
        <div class="col-sm-9">
            <input class="form-control" th:field="*{senderResponsible.responsibleName}" autocomplete="off" th:type="*{documentState.ordinal() == 0} ? 'text' : 'hidden'">
            <label class="form-control" th:text="*{senderResponsible.responsibleName}" th:if="*{documentState.ordinal() != 0}"> Title </label>
        </div>
    </div>
    <!-- Sender Registration Data -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> № Исходящего документа : </span>
        </label>
        <div class="col-sm-9">
            <input class="form-control" required th:field="*{senderRegisteredNumber}" autocomplete="off" th:type="*{documentState.ordinal() == 0} ? 'text' : 'hidden'">
            <label class="form-control" th:text="*{senderRegisteredNumber}" th:if="*{documentState.ordinal() != 0}"> Description </label>
        </div>
    </div>
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Дата : </span>
        </label>
        <div class="col-sm-9">
            <input class="dtp form-control" th:field="*{senderRegisteredDate}" th:type="*{documentState.ordinal() == 0} ? 'text' : 'hidden'" autocomplete="off" readonly="readonly"/>
            <label class="form-control" th:text="*{#dates.format(senderRegisteredDate, 'dd-MM-yyyy')}" th:if="*{documentState.ordinal() != 0}"> Description </label>
        </div>
    </div>
    <!-- TITLE -->
    <div class="form-group m-form__group row" th:hidden="*{documentState.ordinal() > 1 and #strings.length(title) == 0}">
        <label class="col-3 col-form-label">
            <span> Относительно : </span>
        </label>
        <div class="col-sm-9">
            <input class="form-control" th:field="*{title}" autocomplete="off" th:type="*{documentState.ordinal() == 0} ? 'text' : 'hidden'">
            <label class="form-control" th:text="*{title}" th:if="*{documentState.ordinal() != 0}"> Title </label>
        </div>
    </div>
    <!-- DESCRIPTION -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Краткое содержание : </span>
        </label>
        <div class="col-sm-9">
            <textarea th:field="*{description}"></textarea>
        </div>
    </div>
    <!-- Document Due Date -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Срок исполнения документа : </span>
        </label>
        <div class="col-sm-9">
            <input class="dtp form-control" th:field="*{documentDueDate}" th:type="*{documentState.ordinal() == 0} ? 'text' : 'hidden'" autocomplete="off" readonly="readonly"/>
            <label class="form-control" th:text="*{documentDueDate} != null ? *{#dates.format(documentDueDate, 'dd-MM-yyyy')} : 'Срок не установлен'" th:if="*{documentState.ordinal() != 0}"> Title </label>
        </div>
    </div>
    <!-- Receiver Responsible -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Кому на исполнение : </span>
        </label>
        <input type="hidden" id="receiverResponsible.responsibleType" name="receiverResponsible.responsibleType" value="1"/>
        <div class="col-9">
            <div th:hidden="*{documentState.ordinal() > 7}">
                <select class="s2 form-control" th:field="*{receiverResponsible.staff}" multiple="multiple" style="width:100%" data-ajax--url="/doc/data/staff">
                    <option th:each="r : *{receiverResponsible?.staff}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div>
            <label class="form-control" th:each="s : *{receiverResponsible.staff}" th:text="${s.name}" th:if="*{documentState.ordinal() > 7}"> Staff </label>
        </div>
    </div>
    <!-- Attachment -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label"> Приложения : </label>
        <div class="col-9" id="attachmentList">
            <button type="button" class="btn btn-primary mb-3" data-toggle="modal" data-target="#attachment">Добавить</button>
            <input type="hidden" name="files" value="0">
            <table id="documentAttachments" class="form-control">
                <tr th:if="*{not #lists.isEmpty(attachments)}" th:each="attachment : *{attachments}">
                    <td>
                        <a th:href="@{/doc/attachments/download/__${attachment.id}__}">
                            <label th:text="${attachment.name}"></label>
                        </a>
                        <i th:text="'/Автор - ' + ${@userServiceJpaImpl.findById(__${attachment.author}__).staff.name}+'/'"></i>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <!-- Receiver Executor -->
    <div class="form-group m-form__group row" th:if="*{receiverExecutor != null}">
        <label class="col-3 col-form-label">
            <span> Испонители : </span>
        </label>
        <div class="col-9">
            <input type="hidden" th:field="*{receiverExecutor.executorType}"/>
            <select th:field="*{receiverExecutor.staff}" multiple="multiple" style="display: none;">
                <option th:each="r : *{receiverExecutor?.staff}"
                        th:value="${r.id}"
                        th:text="${r.name}">Responsible</option>
            </select>
            <label class="form-control" th:each="s : *{receiverExecutor.staff}" th:text="${s.name}" th:if="*{documentState.ordinal() > 6}"> Staff </label>
        </div>
    </div>
    <!-- Comment -->
    <div class="form-group m-form__group row" th:hidden="${not hasReject}">
        <label class="col-3 col-form-label"> Примечание : </label>
        <div class="col-sm-9">
            <textarea class="form-control" rows="5" th:field="*{comment}" value=" "></textarea>
        </div>
    </div>
    <!-- Receiver Registration Data -->
    <input type="hidden" th:field="*{receiverRegisteredNumber}"/>
    <input type="hidden" th:field="*{receiverRegisteredDate}"/>
</th:block>
<th:block th:fragment="outgoing">
    <!-- Outgoing -->
    <!-- Sender Registration Data -->
    <input type="hidden" th:field="*{senderRegisteredNumber}"/>
    <input type="hidden" th:field="*{senderRegisteredDate}"/>
    <!-- Receiver Responsible -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Кому : </span>
        </label>
        <div th:class="*{documentState.ordinal() > 1} ? 'col-0' : 'col-3'" th:hidden="*{documentState.ordinal() > 1}">
            <select class="s2s form-control" id="rrt_select" th:field="*{receiverResponsible.responsibleType}" style="width: 100%">
                <option value="3">Организация</option>
                <option value="4">ФИЗ Лицо</option>
            </select>
        </div>
        <div th:class="*{documentState.ordinal() > 1} ? 'col-9' : 'col-6'">
            <div class="rdr" id="ri3" th:hidden="*{documentState.ordinal() > 1}">
                <select class="s2 form-control" th:field="*{receiverResponsible.organizations}" multiple="multiple" style="width: 100%" data-ajax--url="/doc/data/organizations">
                    <option th:each="r : *{receiverResponsible?.organizations}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div>
            <div class="rdr" id="ri4" th:hidden="*{documentState.ordinal() > 1}">
                <select class="s2 form-control" th:field="*{receiverResponsible.person}" multiple="multiple" style="width: 100%" data-ajax--url="/doc/data/person">
                    <option th:each="r : *{receiverResponsible?.person}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div>
            <label class="form-control" th:each="s : *{receiverResponsible.organizations}" th:text="${s.name}" th:if="*{documentState.ordinal() > 1}"> Staff </label>
            <label class="form-control" th:each="s : *{receiverResponsible.person}" th:text="${s.name}" th:if="*{documentState.ordinal() > 1}"> Staff </label>
        </div>
    </div>
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span></span>
        </label>
        <div class="col-sm-9">
            <input class="form-control" th:field="*{receiverResponsible.responsibleName}" autocomplete="off" th:type="*{documentState.ordinal() == 0} ? 'text' : 'hidden'">
            <label class="form-control" th:text="*{receiverResponsible.responsibleName}" th:if="*{documentState.ordinal() != 0}"> Title </label>
        </div>
    </div>
    <!-- Sender Responsible -->
    <div class="form-group m-form__group row">
        <input type="hidden" th:field="*{senderResponsible.responsibleType}" value="1"/>
        <label class="col-3 col-form-label">
            <span> От кого : </span>
        </label>
        <div class="col-9">
            <div th:hidden="*{documentState.ordinal() > 1}">
                <select class="s2 form-control" th:field="*{senderResponsible.staff}" multiple="multiple" style="width: 100%" data-ajax--url="/doc/data/staff" required>
                    <option th:each="r : *{senderResponsible?.staff}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div>
            <label class="form-control" th:each="s : *{senderResponsible.staff}" th:text="${s.name}" th:if="*{documentState.ordinal() > 1}"> Staff </label>
        </div>
    </div>
    <!-- TITLE -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Относительно : </span>
        </label>
        <div class="col-sm-9">
            <input class="form-control m-input" th:field="*{title}" autocomplete="off" th:type="*{documentState.ordinal() < 2} ? 'text' : 'hidden'" required>
            <label class="form-control" th:text="*{title}" th:if="*{documentState.ordinal() > 1}"> Title </label>
        </div>
    </div>
    <!-- DESCRIPTION -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Краткое содержание : </span>
        </label>
        <div class="col-sm-9">
            <textarea th:field="*{description}"></textarea>
        </div>
    </div>
    <!-- PAGEINDEX -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span th:utext="|#{label.document.pageIndex} : |"> Номер бланка : </span>
        </label>
        <div class="col-sm-9">
            <input class="form-control m-input" th:field="*{indexNo}" autocomplete="off" th:type="*{documentState.ordinal() < 2} ? 'text' : 'hidden'">
            <label class="form-control" th:text="*{indexNo}" th:if="*{documentState.ordinal() > 1}"> Title </label>
        </div>
    </div>
    <!-- PAGECOUNT -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span th:utext="|#{label.document.pageCount} : |"> Номер бланка : </span>
        </label>
        <div class="col-sm-9">
            <input class="form-control m-input" th:field="*{pageCount}" autocomplete="off" th:type="*{documentState.ordinal() < 2} ? 'number' : 'hidden'">
            <label class="form-control" th:text="*{pageCount}" th:if="*{documentState.ordinal() > 1}"> Title </label>
        </div>
    </div>
    <!-- Attachment -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label"> Приложения : </label>
        <div class="col-9" id="attachmentList">
            <button type="button" class="btn btn-primary mb-3" data-toggle="modal" data-target="#attachment">Добавить</button>
            <input type="hidden" name="files" value="0">
            <table id="documentAttachments" class="form-control">
                <tr th:if="*{#lists.isEmpty(attachments)}"><td><label>Нет приложений</label></td></tr>
                <tr th:if="*{not #lists.isEmpty(attachments)}" th:each="attachment : *{attachments}">
                    <td><a th:href="@{/doc/attachments/download/__${attachment.id}__}"><label th:text="${attachment.name}"></label></a></td>
                </tr>
            </table>
        </div>
    </div>
    <!-- Comment -->
    <div class="form-group m-form__group row" th:if="${hasReject}">
        <label class="col-3 col-form-label">
            <span> Примечание : </span>
        </label>
        <div class="col-sm-9">
            <textarea class="form-control" rows="5" th:field="*{comment}" value=" "></textarea>
        </div>
    </div>
    <!-- Document Link -->
    <!--div class="form-group m-form__group row" sec:authorize="hasAnyAuthority('PERM_ADD_INCOMEDOC')">
        <label class="col-3 col-form-label">
            <span> Ссылка на документ : </span>
        </label>
        <div class="col-9" id="documentList">
            <select class="form-control" th:field="*{documentLinks}" multiple="multiple" style="width: 100%">
                <option th:each="d : ${mydocs}"
                        th:value="${d.id}"
                        th:text="${d.documentSubType.name} + ' № ' + ${d.senderRegisteredNumber}">Responsible</option>
            </select>
            <table class="table table-bordered table-hover">
                <tr th:if="*{not #lists.isEmpty(documentLinks)}" th:each="docs : *{documentLinks}">
                    <td><a th:href="@{/doc/view/__${docs}__}"><label th:text="${mydocs[__${docs}__].title}"></label></a></td>
                </tr>
            </table>
        </div>
    </div-->
</th:block>
</body>
</html>