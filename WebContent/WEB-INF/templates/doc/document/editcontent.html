<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">

<body>
<th:block th:fragment="internal">
    <!-- Sender Registration and Registration Data -->
    <input type="hidden" th:field="*{senderRegisteredNumber}"/>
    <input type="hidden" th:field="*{senderRegisteredDate}"/>
    <input type="hidden" th:field="*{receiverRegisteredNumber}"/>
    <input type="hidden" th:field="*{receiverRegisteredDate}"/>

    <!-- Receiver Responsible -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label"> Кому : </label>
        <div th:class="*{documentState.ordinal() > 1} ? 'col-0' : 'col-3'" th:hidden="*{documentState.ordinal() > 1}">
            <select class="s2s form-control" id="rrt_select" th:field="*{receiverResponsible.responsibleType}" style="width:100%">
                <option value="1">Сотрудник</option>
                <option value="2">Отдел</option>
            </select>
        </div>
        <div th:class="*{documentState.ordinal() > 1} ? 'col-9' : 'col-6'">
            <div class="rdr" id="ri1" th:hidden="*{documentState.ordinal() > 1}">
                <select class="s2 form-control" th:field="*{receiverResponsible.staff}" multiple="multiple" style="width: 100%" data-ajax--url="/doc/data/staff">
                    <option th:each="r : *{receiverResponsible?.staff}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div>
            <div class="rdr" id="ri2" th:hidden="*{documentState.ordinal() > 1}">
                <select class="s2 form-control" th:field="*{receiverResponsible.departments}" multiple="multiple" style="width: 100%" data-ajax--url="/doc/data/department">
                    <option th:each="r : *{receiverResponsible?.departments}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div>
            <label class="form-control" th:each="s : *{receiverResponsible.staff}" th:text="${s.name}" th:if="*{documentState.ordinal() > 1}"> Staff </label>
            <label class="form-control" th:each="d : *{receiverResponsible.departments}" th:text="${d.name}" th:if="*{documentState.ordinal() > 1}"> Staff </label>
        </div>
    </div>
    <!-- Sender Responsible -->
    <div class="form-group m-form__group row">
        <input type="hidden" id="senderResponsible.responsibleType" name="senderResponsible.responsibleType" value="1">
        <label class="col-3 col-form-label"> ОТ : </label>
        <div class="col-9">
            <div th:hidden="*{documentState.ordinal() > 1}">
                <select class="s2 form-control m-input" th:field="*{senderResponsible.staff}" multiple="multiple" data-ajax--url="/doc/data/staff" style="width:100%" required>
                    <option th:each="r : *{senderResponsible?.staff}"
                            th:value="${r.id}"
                            th:text="${r.name}">Staff</option>
                </select>
            </div>
            <label class="form-control" th:each="s : *{senderResponsible.staff}" th:text="${s.name}" th:if="*{documentState.ordinal() > 1}"> Staff </label>
        </div>
    </div>
    <!-- TITLE -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label"> Относительно : </label>
        <div class="col-9">
            <input class="form-control" required th:field="*{title}" autocomplete="off" th:type="*{documentState.ordinal() < 2} ? 'text' : 'hidden'">
            <label class="form-control" th:text="*{title}" th:if="*{documentState.ordinal() > 1}"> Title </label>
        </div>
    </div>
    <!-- DESCRIPTION -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label"> Описание : </label>
        <div class="col-9">
            <textarea th:field="*{description}" required></textarea>
        </div>
    </div>
    <!-- Sender Attachment -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label"> Приложения : </label>
        <div class="col-9">
            <input type="file" id="senderFiles" name="senderFiles" multiple style="display:none" onchange="handleFiles(this.files, 'senderFilesList')">
            <a class="btn" role="button" href="javascript:doClick('senderFiles')" th:if="*{documentState.ordinal() < 2}"> Добавить приложения </a>
            <table id="senderFilesList" class="form-control">
                <tr th:if="*{#lists.isEmpty(senderAttachment)}">
                    <td><label>Нет приложений</label></td>
                </tr>
                <tr th:if="*{not #lists.isEmpty(senderAttachment)}" th:each="attachment : *{senderAttachment}">
                    <td><a th:href="@{/doc/attachments/download/__${attachment.id}__}"><label th:text="${attachment.name}"></label></a></td>
                </tr>
            </table>
        </div>
    </div>
    <!-- Document Due Date -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label"> Срок : </label>
        <div class="col-9">
            <input class="dtp form-control" th:field="*{documentDueDate}" th:type="*{documentState.ordinal() < 2} ? 'text' : 'hidden'" autocomplete="off"/>
            <label class="form-control" data-date-format="dd-mm-yyyy" th:text="*{documentDueDate} != null ? *{#dates.format(documentDueDate, 'dd-MM-yyyy HH:mm')} : 'Срок не установлен'" th:if="*{documentState.ordinal() > 1}"> Title </label>
        </div>
    </div>
    <!-- Receiver Executor -->
    <div class="form-group m-form__group row" th:hidden="*{documentState.ordinal() < 9}">
        <label class="col-3 col-form-label"> Испонитель : </label>
        <div class="col-9">
            <select hidden th:field="*{receiverExecutor.staff}" multiple>
                <option th:each="r : *{receiverExecutor?.staff}"
                        th:value="${r.id}"
                        th:text="${r.name}">Responsible</option>
            </select>
            <label class="form-control" th:each="s : *{receiverExecutor.staff}" th:text="${s.name}"> Staff </label>
        </div>
    </div>
    <!-- Receiver Attachment -->
    <div class="form-group m-form__group row" th:hidden="*{documentState.ordinal() < 8}">
        <label class="col-3 col-form-label"> Приложения : </label>
        <div class="col-9">
            <input type="file" id="receiverFiles" name="receiverFiles" multiple style="display:none" onchange="handleFiles(this.files, 'receiverFilesList')">
            <a class="btn" role="button" href="javascript:doClick('receiverFiles')" th:if="*{documentState.ordinal() > 7}"> Добавить приложения </a>
            <table id="receiverFilesList" class="form-control">
                <tr th:if="*{#lists.isEmpty(receiverAttachment)}">
                    <td><label>Нет приложений</label></td>
                </tr>
                <tr th:if="*{not #lists.isEmpty(receiverAttachment)}" th:each="attachment : *{receiverAttachment}">
                    <td><a th:href="@{/doc/attachments/download/__${attachment.id}__}"><label th:text="${attachment.name}" class="btn" role="button"></label></a></td>
                </tr>
            </table>
        </div>
    </div>
    <!-- Comment -->
    <div class="form-group m-form__group row" th:hidden="${not hasReject}">
        <label class="col-3 col-form-label"> Примечание : </label>
        <div class="col-sm-9">
            <textarea class="form-control" rows="5" th:field="*{comment}" value=" "></textarea>
        </div>
    </div>
</th:block>
<th:block th:fragment="incoming">
    <!-- Sender Registration Data -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> № Регистрации : </span>
        </label>
        <div class="col-sm-9">
            <input class="form-control" required th:field="*{senderRegisteredNumber}" autocomplete="off" th:type="*{documentState.ordinal() == 0} ? 'text' : 'hidden'">
            <label class="form-control" th:text="*{senderRegisteredNumber}" th:if="*{documentState.ordinal() != 0}"> Description </label>
        </div>
    </div>
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Дата регистрации : </span>
        </label>
        <div class="col-sm-9">
            <input class="dtp form-control" th:field="*{senderRegisteredDate}" th:type="*{documentState.ordinal() == 0} ? 'text' : 'hidden'" autocomplete="off"/>
            <label class="form-control" th:text="*{#dates.format(senderRegisteredDate, 'dd-MM-yyyy')}" th:if="*{documentState.ordinal() != 0}"> Description </label>
        </div>
    </div>
    <!-- Receiver Responsible -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Кому : </span>
        </label>

        <div th:class="*{documentState.ordinal() > 0} ? 'col-0' : 'col-3'" th:hidden="*{documentState.ordinal() > 0}">
            <select class="s2s form-control" id="rrt_select" th:field="*{receiverResponsible.responsibleType}" style="width: 100%">
                <option value="3">Организация</option>
                <option value="1">Сотрудник</option>
            </select>
        </div>
        <div th:class="*{documentState.ordinal() > 0} ? 'col-9' : 'col-6'">
            <div class="rdr" id="ri3" th:hidden="*{documentState.ordinal() > 0}">
                <select class="s2s form-control" data-allow-clear="true" th:field="*{receiverResponsible.organizations}" style="width:100%">
                    <option value=""></option>
                    <option value="1">ГАУБК при МФ КР</option>
                </select>
            </div>
            <div class="rdr" id="ri1" th:hidden="*{documentState.ordinal() > 0}">
                <select class="s2 form-control" th:field="*{receiverResponsible.staff}" multiple="multiple" style="width:100%" data-ajax--url="/doc/data/staff">
                    <option th:each="r : *{receiverResponsible?.staff}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div>
            <label class="form-control" th:each="s : *{receiverResponsible.staff}" th:text="${s.name}" th:if="*{documentState.ordinal() > 0}"> Staff </label>
            <label class="form-control" th:each="s : *{receiverResponsible.organizations}" th:text="${s.name}" th:if="*{documentState.ordinal() > 0}"> Staff </label>
        </div>
    </div>
    <!-- Sender Responsible -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> ОТ :  </span>
        </label>
        <div th:class="*{documentState.ordinal() > 0} ? 'col-0' : 'col-3'" th:hidden="*{documentState.ordinal() > 0}">
            <select class="s2s form-control" id="srt_select" th:field="*{senderResponsible.responsibleType}" style="width:100%">
                <option value="3">Организация</option>
                <option value="4">ФИЗ Лицо</option>
            </select>
        </div>
        <div th:class="*{documentState.ordinal() > 0} ? 'col-9' : 'col-6'">
            <div class="sdr" id="si3" th:hidden="*{documentState.ordinal() > 0}">
                <select class="s2 form-control" th:field="*{senderResponsible.organizations}" multiple="multiple" style="width:100%" data-ajax--url="/doc/data/organizations">
                    <option th:each="r : *{senderResponsible?.organizations}"
                            th:value="${r.id}"
                            th:text="${r.name}">Organizations</option>
                </select>
            </div>
            <div class="sdr" id="si4" th:hidden="*{documentState.ordinal() > 0}">
                <select class="s2 form-control" th:field="*{senderResponsible.person}" multiple="multiple" style="width:100%" data-ajax--url="/doc/data/person">
                    <option th:each="r : ${senderResponsible?.person}"
                            th:value="${r.id}"
                            th:text="${r.name}">Person</option>
                </select>
            </div>
            <label class="form-control" th:each="s : *{senderResponsible.organizations}" th:text="${s.name}" th:if="*{documentState.ordinal() > 0}"> Staff </label>
            <label class="form-control" th:each="s : *{senderResponsible.person}" th:text="${s.name}" th:if="*{documentState.ordinal() > 0}"> Staff </label>
        </div>
    </div>
    <!-- TITLE -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Относительно : </span>
        </label>
        <div class="col-sm-9">
            <input class="form-control" required th:field="*{title}" autocomplete="off" th:type="*{documentState.ordinal() == 0} ? 'text' : 'hidden'">
            <label class="form-control" th:text="*{title}" th:if="*{documentState.ordinal() != 0}"> Title </label>
        </div>
    </div>
    <!-- DESCRIPTION -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Описание : </span>
        </label>
        <div class="col-sm-9">
            <textarea th:field="*{description}"></textarea>
        </div>
    </div>
    <!-- Sender Attachment -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Приложения : </span>
        </label>
        <div class="col-sm-9">
            <input type="file" id="senderFiles" name="senderFiles" multiple style="display:none" onchange="handleFiles(this.files, 'senderFilesList')">
            <a class="btn" role="button" href="javascript:doClick('senderFiles')" th:if="*{documentState.ordinal() < 2}"> Добавить приложения </a>
            <table id="senderFilesList" class="form-control">
                <tr th:if="*{#lists.isEmpty(senderAttachment)}"><td><label>Нет приложений</label></td></tr>
                <tr th:if="*{not #lists.isEmpty(senderAttachment)}" th:each="attachment : *{senderAttachment}">
                    <td><a th:href="@{/doc/attachments/download/__${attachment.id}__}"><label th:text="${attachment.name}"></label></a></td>
                </tr>
            </table>
        </div>
    </div>
    <!-- Document Due Date -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Срок : </span>
        </label>
        <div class="col-sm-9">
            <input class="dtp form-control" th:field="*{documentDueDate}" th:type="*{documentState.ordinal() == 0} ? 'text' : 'hidden'" autocomplete="off"/>
            <label class="form-control" th:text="*{documentDueDate} != null ? *{#dates.format(documentDueDate, 'dd-MM-yyyy')} : 'Срок не установлен'" th:if="*{documentState.ordinal() != 0}"> Title </label>
        </div>
    </div>
    <!-- Receiver Executor -->
    <div class="form-group m-form__group row" th:hidden="*{documentState.ordinal() < 5}">
        <label class="col-3 col-form-label">
            <span> Испонитель : </span>
        </label>
        <div class="col-9">
            <div th:hidden="*{documentState.ordinal() > 5}">
                <select class="s2 form-control" th:field="*{receiverExecutor.staff}" multiple="multiple" style="width: 100%" data-ajax--url="/doc/data/staff">
                    <option th:each="r : *{receiverExecutor?.staff}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div>
            <label class="form-control"  th:each="s : *{receiverExecutor.staff}" th:text="${s.name}" th:if="*{documentState.ordinal() > 6}"> Staff </label>
        </div>
    </div>
    <!-- Receiver Attachment -->
    <div class="form-group m-form__group row" th:hidden="*{documentState.ordinal() < 8}">
        <label class="col-3 col-form-label">
            <span> Приложения : </span>
        </label>
        <div class="col-sm-9">
            <input type="file" id="receiverFiles" name="receiverFiles" multiple style="display:none" onchange="handleFiles(this.files, 'receiverFilesList')">
            <a class="btn" role="button" href="javascript:doClick('receiverFiles')" th:if="*{documentState.ordinal() > 7}"> Добавить приложения </a>
            <table id="receiverFilesList" class="form-control">
                <tr th:if="*{#lists.isEmpty(receiverAttachment)}"><td><label>Нет приложений</label></td></tr>
                <tr th:if="*{not #lists.isEmpty(receiverAttachment)}" th:each="attachment : *{receiverAttachment}">
                    <td><a th:href="@{/doc/attachments/download/__${attachment.id}__}"><label th:text="${attachment.name}" class="btn" role="button"></label></a></td>
                </tr>
            </table>
        </div>
    </div>
    <!-- Comment -->
    <div class="form-group m-form__group row" th:hidden="${not hasReject}">
        <label class="col-3 col-form-label"> Примечание : </label>
        <div class="col-sm-9">
            <textarea class="form-control" rows="5" th:field="*{comment}" value=" "></textarea>
        </div>
    </div>
    <!-- Receiver Registration Data -->
    <input type="hidden" th:field="*{receiverRegisteredNumber}"/>
    <input type="hidden" th:field="*{receiverRegisteredDate}"/>
</th:block>
<th:block th:fragment="outgoing">
    <!-- Sender Registration Data -->
    <input type="hidden" th:field="*{senderRegisteredNumber}"/>
    <input type="hidden" th:field="*{senderRegisteredDate}"/>
    <!-- Receiver Responsible -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Кому : </span>
        </label>
        <div th:class="*{documentState.ordinal() > 1} ? 'col-0' : 'col-3'" th:hidden="*{documentState.ordinal() > 1}">
            <select class="s2s form-control" id="rrt_select" th:field="*{receiverResponsible.responsibleType}" style="width: 100%">
                <option value="3">Организация</option>
                <option value="4">ФИЗ Лицо</option>
            </select>
        </div>
        <div th:class="*{documentState.ordinal() > 1} ? 'col-9' : 'col-6'">
            <div class="rdr" id="ri3" th:hidden="*{documentState.ordinal() > 1}">
                <select class="s2 form-control" th:field="*{receiverResponsible.organizations}" multiple="multiple" style="width: 100%" data-ajax--url="/doc/data/organizations">
                    <option th:each="r : *{receiverResponsible?.organizations}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div>
            <div class="rdr" id="ri4" th:hidden="*{documentState.ordinal() > 1}">
                <select class="s2 form-control" th:field="*{receiverResponsible.person}" multiple="multiple" style="width: 100%" data-ajax--url="/doc/data/person">
                    <option th:each="r : *{receiverResponsible?.person}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div>
            <label class="form-control" th:each="s : *{receiverResponsible.organizations}" th:text="${s.name}" th:if="*{documentState.ordinal() > 1}"> Staff </label>
            <label class="form-control" th:each="s : *{receiverResponsible.person}" th:text="${s.name}" th:if="*{documentState.ordinal() > 1}"> Staff </label>
        </div>
    </div>
    <!-- Sender Responsible -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> ОТ :  </span>
        </label>
        <div th:class="*{documentState.ordinal() > 1} ? 'col-0' : 'col-3'" th:hidden="*{documentState.ordinal() > 1}">
            <select class="s2s form-control" id="srt_select" th:field="*{senderResponsible.responsibleType}" style="width: 100%">
                <option value="3">Организация</option>
                <option value="1">Сотрудник</option>
            </select>
        </div>
        <div th:class="*{documentState.ordinal() > 1} ? 'col-9' : 'col-6'">
            <div class="sdr" id="si1" th:hidden="*{documentState.ordinal() > 1}">
                <select class="s2 form-control" th:field="*{senderResponsible.staff}" multiple="multiple" style="width: 100%" data-ajax--url="/doc/data/staff">
                    <option th:each="r : *{senderResponsible?.staff}"
                            th:value="${r.id}"
                            th:text="${r.name}">Responsible</option>
                </select>
            </div>
            <div class="sdr" id="si3" th:hidden="*{documentState.ordinal() > 1}">
                <select class="s2s form-control" th:field="*{senderResponsible.organizations}" style="width: 100%">
                    <option value=""></option>
                    <option value="1">ГАУБК при МФ КР</option>
                </select>
            </div>
            <label class="form-control" th:each="s : *{senderResponsible.staff}" th:text="${s.name}" th:if="*{documentState.ordinal() > 1}"> Staff </label>
            <label class="form-control" th:each="s : *{senderResponsible.organizations}" th:text="${s.name}" th:if="*{documentState.ordinal() > 1}"> Staff </label>
        </div>
    </div>
    <!-- TITLE -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Относительно : </span>
        </label>
        <div class="col-sm-9">
            <input class="form-control m-input" required th:field="*{title}" autocomplete="off" th:type="*{documentState.ordinal() < 2} ? 'text' : 'hidden'">
            <label class="form-control" th:text="*{title}" th:if="*{documentState.ordinal() > 1}"> Title </label>
        </div>
    </div>
    <!-- DESCRIPTION -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Описание : </span>
        </label>
        <div class="col-sm-9">
            <textarea th:field="*{description}"></textarea>
        </div>
    </div>
    <!-- INDEXNO -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Индекс : </span>
        </label>
        <div class="col-sm-9">
            <input class="form-control m-input" required th:field="*{indexNo}" autocomplete="off" th:type="*{documentState.ordinal() < 2} ? 'text' : 'hidden'">
            <label class="form-control" th:text="*{indexNo}" th:if="*{documentState.ordinal() > 1}"> Title </label>
        </div>
    </div>
    <!-- Sender Attachment -->
    <div class="form-group m-form__group row" th:hidden="*{documentState.ordinal() > 1 and senderAttachment == null}">
        <label class="col-3 col-form-label">
            <span> Приложения : </span>
        </label>
        <div class="col-sm-9">
            <input type="file" id="senderFiles" name="senderFiles" multiple style="display:none" onchange="handleFiles(this.files, 'senderFilesList')">
            <a class="btn" role="button" href="javascript:doClick('senderFiles')" th:if="*{documentState.ordinal() < 2}"> Добавить приложения </a>
            <table id="senderFilesList" class="form-control">
                <tr th:if="*{#lists.isEmpty(senderAttachment)}"><td><label>Нет приложений</label></td></tr>
                <tr th:if="*{not #lists.isEmpty(senderAttachment)}" th:each="attachment : *{senderAttachment}">
                    <td><a th:href="@{/doc/attachments/download/__${attachment.id}__}"><label th:text="${attachment.name}"></label></a></td>
                </tr>
            </table>
        </div>
    </div>
    <!-- Document Due Date -->
    <div class="form-group m-form__group row">
        <label class="col-3 col-form-label">
            <span> Срок : </span>
        </label>
        <div class="col-sm-9">
            <input class="dtp form-control" th:field="*{documentDueDate}" th:type="*{documentState.ordinal() < 2} ? 'text' : 'hidden'" autocomplete="off"/>
            <label class="form-control" th:text="*{documentDueDate} != null ? *{#dates.format(documentDueDate, 'dd-MM-yyyy HH:mm')} : 'Срок не установлен'" th:if="*{documentState.ordinal() > 1}"> Title </label>
        </div>
    </div>
    <!-- Comment -->
    <div class="form-group m-form__group row" th:if="${hasReject}">
        <label class="col-3 col-form-label">
            <span> Примечание : </span>
        </label>
        <div class="col-sm-9">
            <textarea class="form-control" rows="5" th:field="*{comment}" value=" "></textarea>
        </div>
    </div>
</th:block>
</body>
</html>